10 ' --- Slot 0
20 ' color 1
30 DATA 00,7F,7F,00,6D,6D,6D,6C,6D,6B,67,6E,6D,00,7F,7F
40 DATA 00,FF,FF,00,DB,BB,73,EB,DB,9B,5B,DB,DB,00,FF,FF
50 ' 
60 ' --- Slot 1
70 ' color 1
80 DATA 00,07,1F,33,73,7F,FF,FF,FF,FF,FF,7F,7F,3F,1F,07
90 DATA 00,C0,F0,98,9C,FC,FE,FE,FE,FE,FE,FC,FC,F8,F0,C0
100 ' 
110 ' --- Slot 2
120 ' color 1
130 DATA 00,07,1F,3F,7F,7F,FF,FF,FF,FF,FF,7F,7F,3F,1F,07
140 DATA 00,C0,F0,F8,FC,E4,E6,FE,FE,FE,E6,E4,FC,F8,F0,C0
150 ' 
160 ' --- Slot 3
170 ' color 1
180 DATA 00,07,1F,3F,7F,7F,FF,FF,FF,FF,FF,7F,73,33,1F,07
190 DATA 00,C0,F0,F8,FC,FC,FE,FE,FE,FE,FE,FC,9C,98,F0,C0
200 ' 
210 ' --- Slot 4
220 ' color 1
230 DATA 00,07,1F,3F,7F,4F,CF,FF,FF,FF,CF,4F,7F,3F,1F,07
240 DATA 00,C0,F0,F8,FC,FC,FE,FE,FE,FE,FE,FC,FC,F8,F0,C0
250 DATA *
260 DEFINT A-Z:COLOR 15,1,1:SCREEN 2,2,0: GOSUB 10000


270 BLOAD "push_gam.sc2",S
280 X=16:Y=16:GS=1:MD=1

300 TIME=0
301 ON GS GOSUB 400,500,600

350 PUT SPRITE 0,(X,Y),8,MD
390 IF TIME<1 THEN 390
399 GOTO 300

400 'IDLE
400 PT=&H1800+X\8+(Y\8)*32:PP=0
401 ON STICK(0) GOTO 410,499,430,499,450,499,470,499
402 GOTO 499

410 MD=1
411 T1=VPEEK(PT-32):T2=VPEEK(PT-31)
412 IF T1=162 THEN GOTO 420
419 GOTO 490
420 IF VPEEK(PT-96)<64 AND VPEEK(PT-95)<64 THEN GS=3:MS=8:PUT SPRITE 1,(X,Y-17),9,0:PP=PT-64:PF=PP-32
429 GOTO 490

430 MD=2:
431 T1=VPEEK(PT+2):T2=VPEEK(PT+34)
432 IF T1=130 THEN GOTO 440
439 GOTO 490
440 IF VPEEK(PT+4)<64 AND VPEEK(PT+36)<64 THEN GS=3:MS=8:PUT SPRITE 1,(X+16,Y-1),9,0:PP=PT+2:PF=PP+1
449 GOTO 490

450 MD=3
451 T1=VPEEK(PT+64):T2=VPEEK(PT+65)
452 IF T1=130 THEN GOTO 460
459 GOTO 490
460 IF VPEEK(PT+128)<64 AND VPEEK(PT+129)<64 THEN GS=3:MS=8:PUT SPRITE 1,(X,Y+15),9,0:PP=PT+64:PF=PP+32
469 GOTO 490

470 MD=4
471 T1=VPEEK(PT-1):T2=VPEEK(PT+31)
472 IF T1=131 THEN GOTO 480
479 GOTO 490
480 IF VPEEK(PT-3)<64 AND VPEEK(PT+29)<64 THEN GS=3:MS=8:PUT SPRITE 1,(X-16,Y-1),9,0:PP=PT-2:PF=PP-1
489 GOTO 490

490 IF T1<64 AND T2<64 THEN GS=2:MS=8
491 IF PP>0 THEN VPOKE PP,2:VPOKE PP+1,3:VPOKE PP+32,34:VPOKE PP+33,35
499 RETURN

500 'MOVING
500 ON MD GOTO 510,520,530,540
510 Y=Y-1:GOTO 550
520 X=X+1:GOTO 550
530 Y=Y+1:GOTO 550
540 X=X-1:GOTO 550
550 MS=MS-1:IF MS=0 THEN GS=1
599 RETURN

600 'PUSHING
600 ON MD GOTO 610,620,630,640
610 Y=Y-1
611 PUT SPRITE 1,(X,Y-17),9,0
612 GOTO 650
620 X=X+1
621 PUT SPRITE 1,(X+16,Y-1),9,0
622 GOTO 650
630 Y=Y+1
631 PUT SPRITE 1,(X,Y+15),9,0
632 GOTO 650
640 X=X-1
641 PUT SPRITE 1,(X-16,Y-1),9,0
642 GOTO 650

650 MS=MS-1
651 IF MS=0 THEN GS=1:VPOKE PF,130:VPOKE PF+1,131:VPOKE PF+32,162:VPOKE PF+33,163:PUT SPRITE 1,(0,0),0,0

699 RETURN

10000 REM -- LOAD SPRITES
10010 S=BASE(9)
10020 READ R$: IF R$="*" THEN RETURN ELSE VPOKE S,VAL("&H"+R$):S=S+1:GOTO 10020
